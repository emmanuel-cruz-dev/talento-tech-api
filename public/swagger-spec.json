{
  "openapi": "3.0.0",
  "info": {
    "title": "Talento Tech API",
    "version": "1.0.0",
    "description": "Esta API proporciona un sistema completo de gestión de productos y usuarios con autenticación JWT."
  },
  "servers": [
    {
      "url": "http://localhost:3000/api/v1",
      "description": "Local"
    },
    {
      "url": "https://talento-tech-api.vercel.app/api/v1",
      "description": "Producción"
    }
  ],
  "tags": [
    {
      "name": "Auth",
      "description": "Endpoints de autenticación (registro, login, perfil)"
    },
    {
      "name": "Users",
      "description": "Gestión de usuarios (solo ADMIN)"
    },
    {
      "name": "Products",
      "description": "CRUD de productos (público para ver, STORE/ADMIN para modificar)"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Ingresa tu token JWT obtenido del login o registro"
      }
    },
    "responses": {
      "UnauthorizedError": {
        "description": "Token de acceso faltante o inválido",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "error": {
                  "type": "string",
                  "example": "Token requerido"
                },
                "message": {
                  "type": "string",
                  "example": "Debes proporcionar un token de autenticación"
                }
              }
            }
          }
        }
      },
      "ForbiddenError": {
        "description": "No tienes permisos para realizar esta acción",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "error": {
                  "type": "string",
                  "example": "Acceso denegado"
                },
                "message": {
                  "type": "string",
                  "example": "Necesitas rol admin para acceder a este recurso"
                },
                "yourRole": {
                  "type": "string",
                  "example": "user"
                }
              }
            }
          }
        }
      }
    },
    "schemas": {
      "SuccessResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Operación exitosa"
          },
          "payload": {
            "type": "object"
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "Error message"
          },
          "message": {
            "type": "string",
            "example": "Detailed error message"
          }
        }
      },
      "ValidationError": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Error de validación en los parámetros"
          },
          "payload": {
            "type": "object",
            "properties": {
              "errors": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "field": {
                      "type": "string",
                      "example": "price"
                    },
                    "message": {
                      "type": "string",
                      "example": "El precio debe ser mayor a 0"
                    },
                    "value": {
                      "example": -10
                    }
                  }
                }
              }
            }
          }
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "prod123"
          },
          "name": {
            "type": "string",
            "example": "Laptop HP"
          },
          "description": {
            "type": "string",
            "example": "High performance laptop"
          },
          "price": {
            "type": "number",
            "format": "float",
            "example": 999.99
          },
          "image": {
            "type": "string",
            "example": "https://example.com/laptop.jpg"
          },
          "category": {
            "type": "string",
            "example": "Electronics"
          },
          "stock": {
            "type": "integer",
            "example": 10
          },
          "rating": {
            "type": "number",
            "format": "float",
            "minimum": 0,
            "maximum": 5,
            "example": 4.5
          },
          "brand": {
            "type": "string",
            "example": "HP"
          },
          "isActive": {
            "type": "boolean",
            "example": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-01T00:00:00.000Z"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-01T00:00:00.000Z"
          },
          "ownerId": {
            "type": "string",
            "example": "store123"
          },
          "ownerName": {
            "type": "string",
            "example": "Tech Store"
          }
        }
      },
      "CreateProductRequest": {
        "type": "object",
        "required": [
          "name",
          "price",
          "category"
        ],
        "properties": {
          "name": {
            "type": "string",
            "example": "New Product"
          },
          "description": {
            "type": "string",
            "example": "Product description"
          },
          "price": {
            "type": "number",
            "format": "float",
            "example": 99.99
          },
          "image": {
            "type": "string",
            "example": "https://example.com/image.jpg"
          },
          "category": {
            "type": "string",
            "example": "Electronics"
          },
          "stock": {
            "type": "integer",
            "default": 0,
            "example": 10
          },
          "rating": {
            "type": "number",
            "format": "float",
            "default": 0,
            "example": 4
          },
          "brand": {
            "type": "string",
            "default": "Sin marca",
            "example": "BrandX"
          },
          "isActive": {
            "type": "boolean",
            "default": true,
            "example": true
          }
        }
      },
      "UpdateProductRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "Updated Product"
          },
          "description": {
            "type": "string",
            "example": "Updated description"
          },
          "price": {
            "type": "number",
            "format": "float",
            "example": 149.99
          },
          "image": {
            "type": "string",
            "example": "https://example.com/new-image.jpg"
          },
          "category": {
            "type": "string",
            "example": "Electronics"
          },
          "stock": {
            "type": "integer",
            "example": 5
          },
          "rating": {
            "type": "number",
            "format": "float",
            "example": 4.5
          },
          "brand": {
            "type": "string",
            "example": "BrandY"
          },
          "isActive": {
            "type": "boolean",
            "example": false
          }
        }
      },
      "PaginatedProducts": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Lista de productos"
          },
          "payload": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Product"
            }
          },
          "pagination": {
            "type": "object",
            "properties": {
              "total": {
                "type": "integer",
                "example": 100
              },
              "page": {
                "type": "integer",
                "example": 1
              },
              "limit": {
                "type": "integer",
                "example": 10
              },
              "totalPages": {
                "type": "integer",
                "example": 10
              },
              "hasNext": {
                "type": "boolean",
                "example": true
              },
              "hasPrev": {
                "type": "boolean",
                "example": false
              },
              "nextCursor": {
                "type": "string",
                "example": "prod456"
              }
            }
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "abc123xyz"
          },
          "email": {
            "type": "string",
            "format": "email",
            "example": "user@example.com"
          },
          "username": {
            "type": "string",
            "example": "johndoe"
          },
          "role": {
            "type": "string",
            "enum": [
              "user",
              "store",
              "admin"
            ],
            "example": "user"
          },
          "isActive": {
            "type": "boolean",
            "example": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-01T00:00:00.000Z"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-01T00:00:00.000Z"
          },
          "profile": {
            "$ref": "#/components/schemas/UserProfile"
          },
          "storeInfo": {
            "$ref": "#/components/schemas/StoreInfo"
          }
        }
      },
      "UserProfile": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "example": "Doe"
          },
          "phone": {
            "type": "string",
            "example": "+1234567890"
          },
          "avatar": {
            "type": "string",
            "example": "https://example.com/avatar.jpg"
          },
          "address": {
            "$ref": "#/components/schemas/Address"
          }
        }
      },
      "Address": {
        "type": "object",
        "properties": {
          "street": {
            "type": "string",
            "example": "123 Main St"
          },
          "city": {
            "type": "string",
            "example": "New York"
          },
          "state": {
            "type": "string",
            "example": "NY"
          },
          "zipCode": {
            "type": "string",
            "example": "10001"
          },
          "country": {
            "type": "string",
            "example": "USA"
          }
        }
      },
      "StoreInfo": {
        "type": "object",
        "properties": {
          "storeName": {
            "type": "string",
            "example": "My Awesome Store"
          },
          "description": {
            "type": "string",
            "example": "We sell quality products"
          },
          "logo": {
            "type": "string",
            "example": "https://example.com/logo.png"
          },
          "verified": {
            "type": "boolean",
            "example": false
          },
          "totalSales": {
            "type": "number",
            "example": 0
          },
          "rating": {
            "type": "number",
            "example": 0
          }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "required": [
          "email",
          "password",
          "username"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "example": "newuser@example.com"
          },
          "password": {
            "type": "string",
            "format": "password",
            "minLength": 6,
            "example": "password123"
          },
          "username": {
            "type": "string",
            "example": "newuser"
          },
          "role": {
            "type": "string",
            "enum": [
              "user",
              "store",
              "admin"
            ],
            "default": "user",
            "example": "user"
          },
          "storeInfo": {
            "$ref": "#/components/schemas/StoreInfoInput"
          },
          "profile": {
            "$ref": "#/components/schemas/UserProfile"
          }
        }
      },
      "StoreInfoInput": {
        "type": "object",
        "required": [
          "storeName"
        ],
        "properties": {
          "storeName": {
            "type": "string",
            "example": "My Store"
          },
          "description": {
            "type": "string",
            "example": "Store description"
          },
          "logo": {
            "type": "string",
            "example": "https://example.com/logo.png"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "example": "user@example.com"
          },
          "password": {
            "type": "string",
            "format": "password",
            "example": "password123"
          }
        }
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Login exitoso"
          },
          "payload": {
            "type": "object",
            "properties": {
              "token": {
                "type": "string",
                "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
              },
              "user": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "example": "abc123"
                  },
                  "email": {
                    "type": "string",
                    "example": "user@example.com"
                  },
                  "username": {
                    "type": "string",
                    "example": "johndoe"
                  },
                  "role": {
                    "type": "string",
                    "example": "user"
                  }
                }
              }
            }
          }
        }
      },
      "ChangePasswordRequest": {
        "type": "object",
        "required": [
          "currentPassword",
          "newPassword"
        ],
        "properties": {
          "currentPassword": {
            "type": "string",
            "format": "password",
            "example": "oldpassword123"
          },
          "newPassword": {
            "type": "string",
            "format": "password",
            "minLength": 6,
            "example": "newpassword123"
          }
        }
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Registrar un nuevo usuario",
        "description": "Crea una nueva cuenta de usuario. Puede ser USER o STORE. Las tiendas deben proporcionar storeInfo.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              },
              "examples": {
                "user": {
                  "summary": "Registrar usuario regular",
                  "value": {
                    "email": "user@example.com",
                    "password": "password123",
                    "username": "johndoe",
                    "role": "user",
                    "profile": {
                      "firstName": "John",
                      "lastName": "Doe"
                    }
                  }
                },
                "store": {
                  "summary": "Registrar tienda",
                  "value": {
                    "email": "store@example.com",
                    "password": "password123",
                    "username": "mystore",
                    "role": "store",
                    "storeInfo": {
                      "storeName": "My Awesome Store",
                      "description": "We sell quality products",
                      "logo": "https://example.com/logo.png"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Usuario registrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Error de validación o email/username ya existe",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "missingFields": {
                    "summary": "Campos faltantes",
                    "value": {
                      "error": "Campos requeridos faltantes",
                      "message": "Email, password y username son requeridos"
                    }
                  },
                  "weakPassword": {
                    "summary": "Contraseña débil",
                    "value": {
                      "error": "Contraseña débil",
                      "message": "La contraseña debe tener al menos 6 caracteres"
                    }
                  },
                  "emailTaken": {
                    "summary": "Email ya registrado",
                    "value": {
                      "error": "Error al registrar usuario",
                      "message": "El email ya está registrado"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Iniciar sesión",
        "description": "Autentica un usuario y devuelve un token JWT válido por 7 días",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login exitoso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Credenciales faltantes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Credenciales inválidas o usuario inactivo",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "invalidCredentials": {
                    "summary": "Credenciales incorrectas",
                    "value": {
                      "error": "Error al iniciar sesión",
                      "message": "Credenciales inválidas"
                    }
                  },
                  "userInactive": {
                    "summary": "Usuario inactivo",
                    "value": {
                      "error": "Error al iniciar sesión",
                      "message": "Usuario inactivo. Contacta al administrador"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auth/profile": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Obtener perfil del usuario autenticado",
        "description": "Devuelve la información del usuario actual basado en el token JWT",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Perfil obtenido exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Perfil obtenido"
                    },
                    "payload": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "abc123"
                        },
                        "email": {
                          "type": "string",
                          "example": "user@example.com"
                        },
                        "username": {
                          "type": "string",
                          "example": "johndoe"
                        },
                        "role": {
                          "type": "string",
                          "example": "user"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/change-password": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Cambiar contraseña",
        "description": "Permite al usuario cambiar su contraseña actual",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contraseña cambiada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Contraseña cambiada exitosamente"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Error de validación o contraseña incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "missingFields": {
                    "summary": "Campos faltantes",
                    "value": {
                      "error": "Campos requeridos",
                      "message": "currentPassword y newPassword son requeridos"
                    }
                  },
                  "weakPassword": {
                    "summary": "Contraseña débil",
                    "value": {
                      "error": "Contraseña débil",
                      "message": "La nueva contraseña debe tener al menos 6 caracteres"
                    }
                  },
                  "wrongPassword": {
                    "summary": "Contraseña actual incorrecta",
                    "value": {
                      "error": "Error al cambiar contraseña",
                      "message": "Contraseña actual incorrecta"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Obtener lista de productos con paginación",
        "description": "Endpoint público para listar productos con filtros, búsqueda y paginación",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 10
            },
            "description": "Número de productos por página"
          },
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "description": "Número de página"
          },
          {
            "in": "query",
            "name": "sortBy",
            "schema": {
              "type": "string",
              "enum": [
                "name",
                "price",
                "createdAt",
                "category",
                "rating",
                "stock",
                "brand"
              ],
              "default": "createdAt"
            },
            "description": "Campo por el cual ordenar"
          },
          {
            "in": "query",
            "name": "order",
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "default": "desc"
            },
            "description": "Orden ascendente o descendente"
          },
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            },
            "description": "Buscar en nombre y descripción del producto"
          },
          {
            "in": "query",
            "name": "category",
            "schema": {
              "type": "string"
            },
            "description": "Filtrar por categoría",
            "example": "Electronics"
          },
          {
            "in": "query",
            "name": "brand",
            "schema": {
              "type": "string"
            },
            "description": "Filtrar por marca",
            "example": "HP"
          },
          {
            "in": "query",
            "name": "minPrice",
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": 0
            },
            "description": "Precio mínimo"
          },
          {
            "in": "query",
            "name": "maxPrice",
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": 0
            },
            "description": "Precio máximo"
          },
          {
            "in": "query",
            "name": "minRating",
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": 0,
              "maximum": 5
            },
            "description": "Rating mínimo"
          },
          {
            "in": "query",
            "name": "isActive",
            "schema": {
              "type": "boolean"
            },
            "description": "Filtrar por productos activos/inactivos"
          },
          {
            "in": "query",
            "name": "ownerId",
            "schema": {
              "type": "string"
            },
            "description": "Filtrar productos por ID de tienda"
          },
          {
            "in": "query",
            "name": "startAfter",
            "schema": {
              "type": "string"
            },
            "description": "Cursor para paginación (ID del último producto)"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de productos obtenida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedProducts"
                }
              }
            }
          },
          "400": {
            "description": "Error de validación en parámetros",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products/{id}": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Obtener un producto por ID",
        "description": "Endpoint público para obtener detalles de un producto específico",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del producto"
          }
        ],
        "responses": {
          "200": {
            "description": "Producto encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "OK"
                    },
                    "payload": {
                      "$ref": "#/components/schemas/Product"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Producto no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Products"
        ],
        "summary": "Actualizar un producto",
        "description": "Solo el STORE dueño del producto o un ADMIN puede actualizarlo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del producto"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProductRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Producto actualizado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "OK"
                    },
                    "payload": {
                      "$ref": "#/components/schemas/Product"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "No tienes permisos para actualizar este producto",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Producto no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Products"
        ],
        "summary": "Eliminar un producto",
        "description": "Solo el STORE dueño del producto o un ADMIN puede eliminarlo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del producto"
          }
        ],
        "responses": {
          "200": {
            "description": "Producto eliminado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Producto con ID 'abc123' eliminado correctamente."
                    },
                    "payload": {
                      "type": "object",
                      "nullable": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "No tienes permisos para eliminar este producto",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Producto no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products/create": {
      "post": {
        "tags": [
          "Products"
        ],
        "summary": "Crear un nuevo producto",
        "description": "Solo usuarios con rol STORE o ADMIN pueden crear productos",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProductRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Producto creado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Producto creado exitosamente"
                    },
                    "payload": {
                      "$ref": "#/components/schemas/Product"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos requeridos faltantes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no tiene rol STORE o ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products/bulk": {
      "post": {
        "tags": [
          "Products"
        ],
        "summary": "Crear múltiples productos",
        "description": "Crea varios productos a la vez. Solo para STORE o ADMIN",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/CreateProductRequest"
                }
              },
              "example": [
                {
                  "name": "Producto 1",
                  "price": 99.99,
                  "category": "Electronics",
                  "description": "Description 1"
                },
                {
                  "name": "Producto 2",
                  "price": 149.99,
                  "category": "Clothing",
                  "description": "Description 2"
                }
              ]
            }
          }
        },
        "responses": {
          "201": {
            "description": "Productos creados exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Productos creados exitosamente"
                    },
                    "createdCount": {
                      "type": "integer",
                      "example": 10
                    },
                    "invalidCount": {
                      "type": "integer",
                      "example": 0
                    },
                    "payload": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "example": "10 productos creados exitosamente"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Array vacío o sin productos válidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no tiene rol STORE o ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Obtener todos los usuarios",
        "description": "Lista todos los usuarios del sistema. Solo accesible para ADMIN",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de usuarios obtenida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Lista de usuarios"
                    },
                    "payload": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/User"
                      }
                    },
                    "total": {
                      "type": "integer",
                      "example": 25
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no es ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Acceso denegado",
                  "message": "Necesitas rol admin para acceder a este recurso",
                  "yourRole": "user"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/role/{role}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Obtener usuarios por rol",
        "description": "Lista usuarios filtrados por rol (user, store, admin). Solo ADMIN",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "role",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "user",
                "store",
                "admin"
              ]
            },
            "description": "Rol de usuario a filtrar"
          }
        ],
        "responses": {
          "200": {
            "description": "Usuarios obtenidos exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Usuarios con rol store"
                    },
                    "payload": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/User"
                      }
                    },
                    "total": {
                      "type": "integer",
                      "example": 5
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Rol inválido",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Rol inválido",
                  "message": "El rol debe ser: user, store, admin"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no es ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Obtener usuario por ID",
        "description": "Obtiene información de un usuario específico. El usuario puede ver su propia info o el ADMIN puede ver cualquier usuario",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del usuario"
          }
        ],
        "responses": {
          "200": {
            "description": "Usuario obtenido exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Usuario obtenido"
                    },
                    "payload": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (intenta ver otro usuario sin ser ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Acceso denegado",
                  "message": "Solo puedes acceder a tus propios recursos"
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Users"
        ],
        "summary": "Actualizar usuario",
        "description": "El usuario puede actualizar su propia información o el ADMIN puede actualizar cualquier usuario. Solo ADMIN puede cambiar roles",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del usuario"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "example": "newemail@example.com"
                  },
                  "username": {
                    "type": "string",
                    "example": "newusername"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "user",
                      "store",
                      "admin"
                    ],
                    "description": "Solo ADMIN puede cambiar roles",
                    "example": "store"
                  },
                  "isActive": {
                    "type": "boolean",
                    "example": true
                  },
                  "profile": {
                    "$ref": "#/components/schemas/UserProfile"
                  },
                  "storeInfo": {
                    "$ref": "#/components/schemas/StoreInfo"
                  }
                }
              },
              "examples": {
                "updateProfile": {
                  "summary": "Actualizar perfil",
                  "value": {
                    "profile": {
                      "firstName": "John",
                      "lastName": "Doe Updated",
                      "phone": "+1234567890"
                    }
                  }
                },
                "changeRole": {
                  "summary": "Cambiar rol (solo ADMIN)",
                  "value": {
                    "role": "store",
                    "storeInfo": {
                      "storeName": "New Store",
                      "description": "Store description"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Usuario actualizado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Usuario actualizado exitosamente"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "notOwner": {
                    "summary": "Intenta actualizar otro usuario",
                    "value": {
                      "error": "Acceso denegado",
                      "message": "Solo puedes acceder a tus propios recursos"
                    }
                  },
                  "changeOwnRole": {
                    "summary": "Usuario intenta cambiar su propio rol",
                    "value": {
                      "error": "Acción no permitida",
                      "message": "No puedes cambiar tu propio rol"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Users"
        ],
        "summary": "Eliminar usuario",
        "description": "Solo ADMIN puede eliminar usuarios. No puede eliminarse a sí mismo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del usuario a eliminar"
          }
        ],
        "responses": {
          "200": {
            "description": "Usuario eliminado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Usuario eliminado exitosamente"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado o intenta eliminarse a sí mismo",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "missingId": {
                    "summary": "ID no proporcionado",
                    "value": {
                      "error": "ID requerido"
                    }
                  },
                  "selfDelete": {
                    "summary": "Intenta eliminarse a sí mismo",
                    "value": {
                      "error": "Acción no permitida",
                      "message": "No puedes eliminar tu propia cuenta"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no es ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{id}/toggle-status": {
      "patch": {
        "tags": [
          "Users"
        ],
        "summary": "Activar/Desactivar usuario",
        "description": "Solo ADMIN puede cambiar el estado de activación de usuarios. No puede desactivarse a sí mismo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del usuario"
          }
        ],
        "responses": {
          "200": {
            "description": "Estado cambiado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Usuario desactivado exitosamente"
                    },
                    "payload": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "abc123"
                        },
                        "isActive": {
                          "type": "boolean",
                          "example": false
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID no proporcionado o intenta desactivarse a sí mismo",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "missingId": {
                    "summary": "ID no proporcionado",
                    "value": {
                      "error": "ID requerido"
                    }
                  },
                  "selfDeactivate": {
                    "summary": "Intenta desactivarse a sí mismo",
                    "value": {
                      "error": "Acción no permitida",
                      "message": "No puedes desactivar tu propia cuenta"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Acceso denegado (no es ADMIN)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  }
}